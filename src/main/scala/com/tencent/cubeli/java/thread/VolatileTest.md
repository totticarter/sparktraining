https://crossoverjie.top/%2F2018%2F03%2F09%2Fvolatile%2F

## volatile作用一

显然这肯定是会出问题的，因此 volatile 的作用出现了：

当一个变量被 volatile 修饰时，任何线程对它的写操作都会立即刷新到主内存中，并且会强制让缓存了该变量的线程中的数据清空，必须从主内存重新读取最新数据。

volatile 修饰之后并不是让线程直接从主内存中获取数据，依然需要将变量拷贝到工作内存中。

### 测试代码说明
运行起来之后,在console输入1,线程A从主内存读到了flag的最新值为false,立刻退出.
而如果把volatile去掉,线程A每次还在自己的工作内存读flag,这其实是一个缓存值,所以线程A一直不退出.

### 问题
1.有没有办法在不使用volatile时,可以让线程A刷新自己的缓存
2.修改为非volatile变量时,线程A为什么一直不退出?

## 指令重排
没怎么看懂